<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Bientôt à l'affiche au Cinéma centre-ville | St-Georges</title>
  <link href="style.css" rel="stylesheet"/> 
</head>
<body>
  <main id="films-container">
    <h1>Films à venir</h1>
  </main>
 <!-- Inclure jQuery AVANT ton script -->
<script src="https://code.jquery.com/jquery-3.6.0.min<script src="cinemascript> 
<script>
  document.addEventListener("DOMContentLoaded", async () => {
    const container = document.getElementById("films-container");

    try {
      const response = await fetch("bientot.json");
      const films = await response.json();

      const filmsParMois = {};
      films.forEach(film => {
        const date = new Date(film.OpeningDate);
        const mois = date.toLocaleString("fr-CA", { month: "long", year: "numeric" });
        if (!filmsParMois[mois]) filmsParMois[mois] = [];
        filmsParMois[mois].push(film);
      });

      for (const [mois, films] of Object.entries(filmsParMois)) {
        const section = document.createElement("section");
        section.innerHTML = `<h2>${mois}</h2>`;

        films.forEach(film => {
          const date = new Date(film.OpeningDate);
          const dateStr = date.toLocaleDateString("fr-CA", {
            day: "numeric",
            month: "long",
            year: "numeric"
          });

          const bandeAnnonceURL = film.bande_annonce?.replace("watch?v=", "embed/") ?? "";
          const bandeAnnonceHTML = bandeAnnonceURL
            ? `<iframe width="560" height="315" src="${bandeAnnonceURL}" frame afficheHTML = film.affiche
            ? `${film.affiche}`
            : "";

          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <h3>${film.Title}</h3>
            <div class="poster">
              ${afficheHTML}
              <div class="date">Sortie : ${dateStr}</div>
            </div>
            <div class="trailer">
              ${bandeAnnonceHTML}
            </div>
            <p>${film.Description ?? ""}</p>
          `;
          section.appendChild(card);
        });

        container.appendChild(section);
      }

      if (films.length === 0) {
        container.innerHTML += "<p>Aucun film à venir pour le moment.</p>";
      }

    } catch (error) {
      console.error("Erreur lors du chargement des films :", error);
      container.innerHTML += "<p>Impossible de charger les films pour le moment.</p>";
    }
  });
</script>

</body>
</html>
